{"ast":null,"code":"var semver = require(\"semver\");\n\nvar validateLicense = require('validate-npm-package-license');\n\nvar hostedGitInfo = require(\"hosted-git-info\");\n\nvar isBuiltinModule = require(\"resolve\").isCore;\n\nvar depTypes = [\"dependencies\", \"devDependencies\", \"optionalDependencies\"];\n\nvar extractDescription = require(\"./extract_description\");\n\nvar url = require(\"url\");\n\nvar typos = require(\"./typos.json\");\n\nvar fixer = module.exports = {\n  // default warning function\n  warn: function () {},\n  fixRepositoryField: function (data) {\n    if (data.repositories) {\n      this.warn(\"repositories\");\n      data.repository = data.repositories[0];\n    }\n\n    if (!data.repository) return this.warn(\"missingRepository\");\n\n    if (typeof data.repository === \"string\") {\n      data.repository = {\n        type: \"git\",\n        url: data.repository\n      };\n    }\n\n    var r = data.repository.url || \"\";\n\n    if (r) {\n      var hosted = hostedGitInfo.fromUrl(r);\n\n      if (hosted) {\n        r = data.repository.url = hosted.getDefaultRepresentation() == \"shortcut\" ? hosted.https() : hosted.toString();\n      }\n    }\n\n    if (r.match(/github.com\\/[^\\/]+\\/[^\\/]+\\.git\\.git$/)) {\n      this.warn(\"brokenGitUrl\", r);\n    }\n  },\n  fixTypos: function (data) {\n    Object.keys(typos.topLevel).forEach(function (d) {\n      if (data.hasOwnProperty(d)) {\n        this.warn(\"typo\", d, typos.topLevel[d]);\n      }\n    }, this);\n  },\n  fixScriptsField: function (data) {\n    if (!data.scripts) return;\n\n    if (typeof data.scripts !== \"object\") {\n      this.warn(\"nonObjectScripts\");\n      delete data.scripts;\n      return;\n    }\n\n    Object.keys(data.scripts).forEach(function (k) {\n      if (typeof data.scripts[k] !== \"string\") {\n        this.warn(\"nonStringScript\");\n        delete data.scripts[k];\n      } else if (typos.script[k] && !data.scripts[typos.script[k]]) {\n        this.warn(\"typo\", k, typos.script[k], \"scripts\");\n      }\n    }, this);\n  },\n  fixFilesField: function (data) {\n    var files = data.files;\n\n    if (files && !Array.isArray(files)) {\n      this.warn(\"nonArrayFiles\");\n      delete data.files;\n    } else if (data.files) {\n      data.files = data.files.filter(function (file) {\n        if (!file || typeof file !== \"string\") {\n          this.warn(\"invalidFilename\", file);\n          return false;\n        } else {\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixBinField: function (data) {\n    if (!data.bin) return;\n\n    if (typeof data.bin === \"string\") {\n      var b = {};\n      var match;\n\n      if (match = data.name.match(/^@[^/]+[/](.*)$/)) {\n        b[match[1]] = data.bin;\n      } else {\n        b[data.name] = data.bin;\n      }\n\n      data.bin = b;\n    }\n  },\n  fixManField: function (data) {\n    if (!data.man) return;\n\n    if (typeof data.man === \"string\") {\n      data.man = [data.man];\n    }\n  },\n  fixBundleDependenciesField: function (data) {\n    var bdd = \"bundledDependencies\";\n    var bd = \"bundleDependencies\";\n\n    if (data[bdd] && !data[bd]) {\n      data[bd] = data[bdd];\n      delete data[bdd];\n    }\n\n    if (data[bd] && !Array.isArray(data[bd])) {\n      this.warn(\"nonArrayBundleDependencies\");\n      delete data[bd];\n    } else if (data[bd]) {\n      data[bd] = data[bd].filter(function (bd) {\n        if (!bd || typeof bd !== 'string') {\n          this.warn(\"nonStringBundleDependency\", bd);\n          return false;\n        } else {\n          if (!data.dependencies) {\n            data.dependencies = {};\n          }\n\n          if (!data.dependencies.hasOwnProperty(bd)) {\n            this.warn(\"nonDependencyBundleDependency\", bd);\n            data.dependencies[bd] = \"*\";\n          }\n\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixDependencies: function (data, strict) {\n    var loose = !strict;\n    objectifyDeps(data, this.warn);\n    addOptionalDepsToDeps(data, this.warn);\n    this.fixBundleDependenciesField(data);\n    ['dependencies', 'devDependencies'].forEach(function (deps) {\n      if (!(deps in data)) return;\n\n      if (!data[deps] || typeof data[deps] !== \"object\") {\n        this.warn(\"nonObjectDependencies\", deps);\n        delete data[deps];\n        return;\n      }\n\n      Object.keys(data[deps]).forEach(function (d) {\n        var r = data[deps][d];\n\n        if (typeof r !== 'string') {\n          this.warn(\"nonStringDependency\", d, JSON.stringify(r));\n          delete data[deps][d];\n        }\n\n        var hosted = hostedGitInfo.fromUrl(data[deps][d]);\n        if (hosted) data[deps][d] = hosted.toString();\n      }, this);\n    }, this);\n  },\n  fixModulesField: function (data) {\n    if (data.modules) {\n      this.warn(\"deprecatedModules\");\n      delete data.modules;\n    }\n  },\n  fixKeywordsField: function (data) {\n    if (typeof data.keywords === \"string\") {\n      data.keywords = data.keywords.split(/,\\s+/);\n    }\n\n    if (data.keywords && !Array.isArray(data.keywords)) {\n      delete data.keywords;\n      this.warn(\"nonArrayKeywords\");\n    } else if (data.keywords) {\n      data.keywords = data.keywords.filter(function (kw) {\n        if (typeof kw !== \"string\" || !kw) {\n          this.warn(\"nonStringKeyword\");\n          return false;\n        } else {\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixVersionField: function (data, strict) {\n    // allow \"loose\" semver 1.0 versions in non-strict mode\n    // enforce strict semver 2.0 compliance in strict mode\n    var loose = !strict;\n\n    if (!data.version) {\n      data.version = \"\";\n      return true;\n    }\n\n    if (!semver.valid(data.version, loose)) {\n      throw new Error('Invalid version: \"' + data.version + '\"');\n    }\n\n    data.version = semver.clean(data.version, loose);\n    return true;\n  },\n  fixPeople: function (data) {\n    modifyPeople(data, unParsePerson);\n    modifyPeople(data, parsePerson);\n  },\n  fixNameField: function (data, options) {\n    if (typeof options === \"boolean\") options = {\n      strict: options\n    };else if (typeof options === \"undefined\") options = {};\n    var strict = options.strict;\n\n    if (!data.name && !strict) {\n      data.name = \"\";\n      return;\n    }\n\n    if (typeof data.name !== \"string\") {\n      throw new Error(\"name field must be a string.\");\n    }\n\n    if (!strict) data.name = data.name.trim();\n    ensureValidName(data.name, strict, options.allowLegacyCase);\n    if (isBuiltinModule(data.name)) this.warn(\"conflictingName\", data.name);\n  },\n  fixDescriptionField: function (data) {\n    if (data.description && typeof data.description !== 'string') {\n      this.warn(\"nonStringDescription\");\n      delete data.description;\n    }\n\n    if (data.readme && !data.description) data.description = extractDescription(data.readme);\n    if (data.description === undefined) delete data.description;\n    if (!data.description) this.warn(\"missingDescription\");\n  },\n  fixReadmeField: function (data) {\n    if (!data.readme) {\n      this.warn(\"missingReadme\");\n      data.readme = \"ERROR: No README data found!\";\n    }\n  },\n  fixBugsField: function (data) {\n    if (!data.bugs && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url);\n\n      if (hosted && hosted.bugs()) {\n        data.bugs = {\n          url: hosted.bugs()\n        };\n      }\n    } else if (data.bugs) {\n      var emailRe = /^.+@.*\\..+$/;\n\n      if (typeof data.bugs == \"string\") {\n        if (emailRe.test(data.bugs)) data.bugs = {\n          email: data.bugs\n        };else if (url.parse(data.bugs).protocol) data.bugs = {\n          url: data.bugs\n        };else this.warn(\"nonEmailUrlBugsString\");\n      } else {\n        bugsTypos(data.bugs, this.warn);\n        var oldBugs = data.bugs;\n        data.bugs = {};\n\n        if (oldBugs.url) {\n          if (typeof oldBugs.url == \"string\" && url.parse(oldBugs.url).protocol) data.bugs.url = oldBugs.url;else this.warn(\"nonUrlBugsUrlField\");\n        }\n\n        if (oldBugs.email) {\n          if (typeof oldBugs.email == \"string\" && emailRe.test(oldBugs.email)) data.bugs.email = oldBugs.email;else this.warn(\"nonEmailBugsEmailField\");\n        }\n      }\n\n      if (!data.bugs.email && !data.bugs.url) {\n        delete data.bugs;\n        this.warn(\"emptyNormalizedBugs\");\n      }\n    }\n  },\n  fixHomepageField: function (data) {\n    if (!data.homepage && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url);\n      if (hosted && hosted.docs()) data.homepage = hosted.docs();\n    }\n\n    if (!data.homepage) return;\n\n    if (typeof data.homepage !== \"string\") {\n      this.warn(\"nonUrlHomepage\");\n      return delete data.homepage;\n    }\n\n    if (!url.parse(data.homepage).protocol) {\n      data.homepage = \"http://\" + data.homepage;\n    }\n  },\n  fixLicenseField: function (data) {\n    if (!data.license) {\n      return this.warn(\"missingLicense\");\n    } else {\n      if (typeof data.license !== 'string' || data.license.length < 1 || data.license.trim() === '') {\n        this.warn(\"invalidLicense\");\n      } else {\n        if (!validateLicense(data.license).validForNewPackages) this.warn(\"invalidLicense\");\n      }\n    }\n  }\n};\n\nfunction isValidScopedPackageName(spec) {\n  if (spec.charAt(0) !== '@') return false;\n  var rest = spec.slice(1).split('/');\n  if (rest.length !== 2) return false;\n  return rest[0] && rest[1] && rest[0] === encodeURIComponent(rest[0]) && rest[1] === encodeURIComponent(rest[1]);\n}\n\nfunction isCorrectlyEncodedName(spec) {\n  return !spec.match(/[\\/@\\s\\+%:]/) && spec === encodeURIComponent(spec);\n}\n\nfunction ensureValidName(name, strict, allowLegacyCase) {\n  if (name.charAt(0) === \".\" || !(isValidScopedPackageName(name) || isCorrectlyEncodedName(name)) || strict && !allowLegacyCase && name !== name.toLowerCase() || name.toLowerCase() === \"node_modules\" || name.toLowerCase() === \"favicon.ico\") {\n    throw new Error(\"Invalid name: \" + JSON.stringify(name));\n  }\n}\n\nfunction modifyPeople(data, fn) {\n  if (data.author) data.author = fn(data.author);\n  [\"maintainers\", \"contributors\"].forEach(function (set) {\n    if (!Array.isArray(data[set])) return;\n    data[set] = data[set].map(fn);\n  });\n  return data;\n}\n\nfunction unParsePerson(person) {\n  if (typeof person === \"string\") return person;\n  var name = person.name || \"\";\n  var u = person.url || person.web;\n  var url = u ? \" (\" + u + \")\" : \"\";\n  var e = person.email || person.mail;\n  var email = e ? \" <\" + e + \">\" : \"\";\n  return name + email + url;\n}\n\nfunction parsePerson(person) {\n  if (typeof person !== \"string\") return person;\n  var name = person.match(/^([^\\(<]+)/);\n  var url = person.match(/\\(([^\\)]+)\\)/);\n  var email = person.match(/<([^>]+)>/);\n  var obj = {};\n  if (name && name[0].trim()) obj.name = name[0].trim();\n  if (email) obj.email = email[1];\n  if (url) obj.url = url[1];\n  return obj;\n}\n\nfunction addOptionalDepsToDeps(data, warn) {\n  var o = data.optionalDependencies;\n  if (!o) return;\n  var d = data.dependencies || {};\n  Object.keys(o).forEach(function (k) {\n    d[k] = o[k];\n  });\n  data.dependencies = d;\n}\n\nfunction depObjectify(deps, type, warn) {\n  if (!deps) return {};\n\n  if (typeof deps === \"string\") {\n    deps = deps.trim().split(/[\\n\\r\\s\\t ,]+/);\n  }\n\n  if (!Array.isArray(deps)) return deps;\n  warn(\"deprecatedArrayDependencies\", type);\n  var o = {};\n  deps.filter(function (d) {\n    return typeof d === \"string\";\n  }).forEach(function (d) {\n    d = d.trim().split(/(:?[@\\s><=])/);\n    var dn = d.shift();\n    var dv = d.join(\"\");\n    dv = dv.trim();\n    dv = dv.replace(/^@/, \"\");\n    o[dn] = dv;\n  });\n  return o;\n}\n\nfunction objectifyDeps(data, warn) {\n  depTypes.forEach(function (type) {\n    if (!data[type]) return;\n    data[type] = depObjectify(data[type], type, warn);\n  });\n}\n\nfunction bugsTypos(bugs, warn) {\n  if (!bugs) return;\n  Object.keys(bugs).forEach(function (k) {\n    if (typos.bugs[k]) {\n      warn(\"typo\", k, typos.bugs[k], \"bugs\");\n      bugs[typos.bugs[k]] = bugs[k];\n      delete bugs[k];\n    }\n  });\n}","map":{"version":3,"sources":["/Users/tylerlane/Documents/MondayApps/bookmarks/quickstart-react/node_modules/normalize-package-data/lib/fixer.js"],"names":["semver","require","validateLicense","hostedGitInfo","isBuiltinModule","isCore","depTypes","extractDescription","url","typos","fixer","module","exports","warn","fixRepositoryField","data","repositories","repository","type","r","hosted","fromUrl","getDefaultRepresentation","https","toString","match","fixTypos","Object","keys","topLevel","forEach","d","hasOwnProperty","fixScriptsField","scripts","k","script","fixFilesField","files","Array","isArray","filter","file","fixBinField","bin","b","name","fixManField","man","fixBundleDependenciesField","bdd","bd","dependencies","fixDependencies","strict","loose","objectifyDeps","addOptionalDepsToDeps","deps","JSON","stringify","fixModulesField","modules","fixKeywordsField","keywords","split","kw","fixVersionField","version","valid","Error","clean","fixPeople","modifyPeople","unParsePerson","parsePerson","fixNameField","options","trim","ensureValidName","allowLegacyCase","fixDescriptionField","description","readme","undefined","fixReadmeField","fixBugsField","bugs","emailRe","test","email","parse","protocol","bugsTypos","oldBugs","fixHomepageField","homepage","docs","fixLicenseField","license","length","validForNewPackages","isValidScopedPackageName","spec","charAt","rest","slice","encodeURIComponent","isCorrectlyEncodedName","toLowerCase","fn","author","set","map","person","u","web","e","mail","obj","o","optionalDependencies","depObjectify","dn","shift","dv","join","replace"],"mappings":"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","sourcesContent":["var semver = require(\"semver\")\nvar validateLicense = require('validate-npm-package-license');\nvar hostedGitInfo = require(\"hosted-git-info\")\nvar isBuiltinModule = require(\"resolve\").isCore\nvar depTypes = [\"dependencies\",\"devDependencies\",\"optionalDependencies\"]\nvar extractDescription = require(\"./extract_description\")\nvar url = require(\"url\")\nvar typos = require(\"./typos.json\")\n\nvar fixer = module.exports = {\n  // default warning function\n  warn: function() {},\n\n  fixRepositoryField: function(data) {\n    if (data.repositories) {\n      this.warn(\"repositories\");\n      data.repository = data.repositories[0]\n    }\n    if (!data.repository) return this.warn(\"missingRepository\")\n    if (typeof data.repository === \"string\") {\n      data.repository = {\n        type: \"git\",\n        url: data.repository\n      }\n    }\n    var r = data.repository.url || \"\"\n    if (r) {\n      var hosted = hostedGitInfo.fromUrl(r)\n      if (hosted) {\n        r = data.repository.url\n          = hosted.getDefaultRepresentation() == \"shortcut\" ? hosted.https() : hosted.toString()\n      }\n    }\n\n    if (r.match(/github.com\\/[^\\/]+\\/[^\\/]+\\.git\\.git$/)) {\n      this.warn(\"brokenGitUrl\", r)\n    }\n  }\n\n, fixTypos: function(data) {\n    Object.keys(typos.topLevel).forEach(function (d) {\n      if (data.hasOwnProperty(d)) {\n        this.warn(\"typo\", d, typos.topLevel[d])\n      }\n    }, this)\n  }\n\n, fixScriptsField: function(data) {\n    if (!data.scripts) return\n    if (typeof data.scripts !== \"object\") {\n      this.warn(\"nonObjectScripts\")\n      delete data.scripts\n      return\n    }\n    Object.keys(data.scripts).forEach(function (k) {\n      if (typeof data.scripts[k] !== \"string\") {\n        this.warn(\"nonStringScript\")\n        delete data.scripts[k]\n      } else if (typos.script[k] && !data.scripts[typos.script[k]]) {\n        this.warn(\"typo\", k, typos.script[k], \"scripts\")\n      }\n    }, this)\n  }\n\n, fixFilesField: function(data) {\n    var files = data.files\n    if (files && !Array.isArray(files)) {\n      this.warn(\"nonArrayFiles\")\n      delete data.files\n    } else if (data.files) {\n      data.files = data.files.filter(function(file) {\n        if (!file || typeof file !== \"string\") {\n          this.warn(\"invalidFilename\", file)\n          return false\n        } else {\n          return true\n        }\n      }, this)\n    }\n  }\n\n, fixBinField: function(data) {\n    if (!data.bin) return;\n    if (typeof data.bin === \"string\") {\n      var b = {}\n      var match\n      if (match = data.name.match(/^@[^/]+[/](.*)$/)) {\n        b[match[1]] = data.bin\n      } else {\n        b[data.name] = data.bin\n      }\n      data.bin = b\n    }\n  }\n\n, fixManField: function(data) {\n    if (!data.man) return;\n    if (typeof data.man === \"string\") {\n      data.man = [ data.man ]\n    }\n  }\n, fixBundleDependenciesField: function(data) {\n    var bdd = \"bundledDependencies\"\n    var bd = \"bundleDependencies\"\n    if (data[bdd] && !data[bd]) {\n      data[bd] = data[bdd]\n      delete data[bdd]\n    }\n    if (data[bd] && !Array.isArray(data[bd])) {\n      this.warn(\"nonArrayBundleDependencies\")\n      delete data[bd]\n    } else if (data[bd]) {\n      data[bd] = data[bd].filter(function(bd) {\n        if (!bd || typeof bd !== 'string') {\n          this.warn(\"nonStringBundleDependency\", bd)\n          return false\n        } else {\n          if (!data.dependencies) {\n            data.dependencies = {}\n          }\n          if (!data.dependencies.hasOwnProperty(bd)) {\n            this.warn(\"nonDependencyBundleDependency\", bd)\n            data.dependencies[bd] = \"*\"\n          }\n          return true\n        }\n      }, this)\n    }\n  }\n\n, fixDependencies: function(data, strict) {\n    var loose = !strict\n    objectifyDeps(data, this.warn)\n    addOptionalDepsToDeps(data, this.warn)\n    this.fixBundleDependenciesField(data)\n\n    ;['dependencies','devDependencies'].forEach(function(deps) {\n      if (!(deps in data)) return\n      if (!data[deps] || typeof data[deps] !== \"object\") {\n        this.warn(\"nonObjectDependencies\", deps)\n        delete data[deps]\n        return\n      }\n      Object.keys(data[deps]).forEach(function (d) {\n        var r = data[deps][d]\n        if (typeof r !== 'string') {\n          this.warn(\"nonStringDependency\", d, JSON.stringify(r))\n          delete data[deps][d]\n        }\n        var hosted = hostedGitInfo.fromUrl(data[deps][d])\n        if (hosted) data[deps][d] = hosted.toString()\n      }, this)\n    }, this)\n  }\n\n, fixModulesField: function (data) {\n    if (data.modules) {\n      this.warn(\"deprecatedModules\")\n      delete data.modules\n    }\n  }\n\n, fixKeywordsField: function (data) {\n    if (typeof data.keywords === \"string\") {\n      data.keywords = data.keywords.split(/,\\s+/)\n    }\n    if (data.keywords && !Array.isArray(data.keywords)) {\n      delete data.keywords\n      this.warn(\"nonArrayKeywords\")\n    } else if (data.keywords) {\n      data.keywords = data.keywords.filter(function(kw) {\n        if (typeof kw !== \"string\" || !kw) {\n          this.warn(\"nonStringKeyword\");\n          return false\n        } else {\n          return true\n        }\n      }, this)\n    }\n  }\n\n, fixVersionField: function(data, strict) {\n    // allow \"loose\" semver 1.0 versions in non-strict mode\n    // enforce strict semver 2.0 compliance in strict mode\n    var loose = !strict\n    if (!data.version) {\n      data.version = \"\"\n      return true\n    }\n    if (!semver.valid(data.version, loose)) {\n      throw new Error('Invalid version: \"'+ data.version + '\"')\n    }\n    data.version = semver.clean(data.version, loose)\n    return true\n  }\n\n, fixPeople: function(data) {\n    modifyPeople(data, unParsePerson)\n    modifyPeople(data, parsePerson)\n  }\n\n, fixNameField: function(data, options) {\n    if (typeof options === \"boolean\") options = {strict: options}\n    else if (typeof options === \"undefined\") options = {}\n    var strict = options.strict\n    if (!data.name && !strict) {\n      data.name = \"\"\n      return\n    }\n    if (typeof data.name !== \"string\") {\n      throw new Error(\"name field must be a string.\")\n    }\n    if (!strict)\n      data.name = data.name.trim()\n    ensureValidName(data.name, strict, options.allowLegacyCase)\n    if (isBuiltinModule(data.name))\n      this.warn(\"conflictingName\", data.name)\n  }\n\n\n, fixDescriptionField: function (data) {\n    if (data.description && typeof data.description !== 'string') {\n      this.warn(\"nonStringDescription\")\n      delete data.description\n    }\n    if (data.readme && !data.description)\n      data.description = extractDescription(data.readme)\n      if(data.description === undefined) delete data.description;\n    if (!data.description) this.warn(\"missingDescription\")\n  }\n\n, fixReadmeField: function (data) {\n    if (!data.readme) {\n      this.warn(\"missingReadme\")\n      data.readme = \"ERROR: No README data found!\"\n    }\n  }\n\n, fixBugsField: function(data) {\n    if (!data.bugs && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url)\n      if(hosted && hosted.bugs()) {\n        data.bugs = {url: hosted.bugs()}\n      }\n    }\n    else if(data.bugs) {\n      var emailRe = /^.+@.*\\..+$/\n      if(typeof data.bugs == \"string\") {\n        if(emailRe.test(data.bugs))\n          data.bugs = {email:data.bugs}\n        else if(url.parse(data.bugs).protocol)\n          data.bugs = {url: data.bugs}\n        else\n          this.warn(\"nonEmailUrlBugsString\")\n      }\n      else {\n        bugsTypos(data.bugs, this.warn)\n        var oldBugs = data.bugs\n        data.bugs = {}\n        if(oldBugs.url) {\n          if(typeof(oldBugs.url) == \"string\" && url.parse(oldBugs.url).protocol)\n            data.bugs.url = oldBugs.url\n          else\n            this.warn(\"nonUrlBugsUrlField\")\n        }\n        if(oldBugs.email) {\n          if(typeof(oldBugs.email) == \"string\" && emailRe.test(oldBugs.email))\n            data.bugs.email = oldBugs.email\n          else\n            this.warn(\"nonEmailBugsEmailField\")\n        }\n      }\n      if(!data.bugs.email && !data.bugs.url) {\n        delete data.bugs\n        this.warn(\"emptyNormalizedBugs\")\n      }\n    }\n  }\n\n, fixHomepageField: function(data) {\n    if (!data.homepage && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url)\n      if (hosted && hosted.docs()) data.homepage = hosted.docs()\n    }\n    if (!data.homepage) return\n\n    if(typeof data.homepage !== \"string\") {\n      this.warn(\"nonUrlHomepage\")\n      return delete data.homepage\n    }\n    if(!url.parse(data.homepage).protocol) {\n      data.homepage = \"http://\" + data.homepage\n    }\n  }\n\n, fixLicenseField: function(data) {\n    if (!data.license) {\n      return this.warn(\"missingLicense\")\n    } else{\n      if (\n        typeof(data.license) !== 'string' ||\n        data.license.length < 1 ||\n        data.license.trim() === ''\n      ) {\n        this.warn(\"invalidLicense\")\n      } else {\n        if (!validateLicense(data.license).validForNewPackages)\n          this.warn(\"invalidLicense\")\n      }\n    }\n  }\n}\n\nfunction isValidScopedPackageName(spec) {\n  if (spec.charAt(0) !== '@') return false\n\n  var rest = spec.slice(1).split('/')\n  if (rest.length !== 2) return false\n\n  return rest[0] && rest[1] &&\n    rest[0] === encodeURIComponent(rest[0]) &&\n    rest[1] === encodeURIComponent(rest[1])\n}\n\nfunction isCorrectlyEncodedName(spec) {\n  return !spec.match(/[\\/@\\s\\+%:]/) &&\n    spec === encodeURIComponent(spec)\n}\n\nfunction ensureValidName (name, strict, allowLegacyCase) {\n  if (name.charAt(0) === \".\" ||\n      !(isValidScopedPackageName(name) || isCorrectlyEncodedName(name)) ||\n      (strict && (!allowLegacyCase) && name !== name.toLowerCase()) ||\n      name.toLowerCase() === \"node_modules\" ||\n      name.toLowerCase() === \"favicon.ico\") {\n        throw new Error(\"Invalid name: \" + JSON.stringify(name))\n  }\n}\n\nfunction modifyPeople (data, fn) {\n  if (data.author) data.author = fn(data.author)\n  ;[\"maintainers\", \"contributors\"].forEach(function (set) {\n    if (!Array.isArray(data[set])) return;\n    data[set] = data[set].map(fn)\n  })\n  return data\n}\n\nfunction unParsePerson (person) {\n  if (typeof person === \"string\") return person\n  var name = person.name || \"\"\n  var u = person.url || person.web\n  var url = u ? (\" (\"+u+\")\") : \"\"\n  var e = person.email || person.mail\n  var email = e ? (\" <\"+e+\">\") : \"\"\n  return name+email+url\n}\n\nfunction parsePerson (person) {\n  if (typeof person !== \"string\") return person\n  var name = person.match(/^([^\\(<]+)/)\n  var url = person.match(/\\(([^\\)]+)\\)/)\n  var email = person.match(/<([^>]+)>/)\n  var obj = {}\n  if (name && name[0].trim()) obj.name = name[0].trim()\n  if (email) obj.email = email[1];\n  if (url) obj.url = url[1];\n  return obj\n}\n\nfunction addOptionalDepsToDeps (data, warn) {\n  var o = data.optionalDependencies\n  if (!o) return;\n  var d = data.dependencies || {}\n  Object.keys(o).forEach(function (k) {\n    d[k] = o[k]\n  })\n  data.dependencies = d\n}\n\nfunction depObjectify (deps, type, warn) {\n  if (!deps) return {}\n  if (typeof deps === \"string\") {\n    deps = deps.trim().split(/[\\n\\r\\s\\t ,]+/)\n  }\n  if (!Array.isArray(deps)) return deps\n  warn(\"deprecatedArrayDependencies\", type)\n  var o = {}\n  deps.filter(function (d) {\n    return typeof d === \"string\"\n  }).forEach(function(d) {\n    d = d.trim().split(/(:?[@\\s><=])/)\n    var dn = d.shift()\n    var dv = d.join(\"\")\n    dv = dv.trim()\n    dv = dv.replace(/^@/, \"\")\n    o[dn] = dv\n  })\n  return o\n}\n\nfunction objectifyDeps (data, warn) {\n  depTypes.forEach(function (type) {\n    if (!data[type]) return;\n    data[type] = depObjectify(data[type], type, warn)\n  })\n}\n\nfunction bugsTypos(bugs, warn) {\n  if (!bugs) return\n  Object.keys(bugs).forEach(function (k) {\n    if (typos.bugs[k]) {\n      warn(\"typo\", k, typos.bugs[k], \"bugs\")\n      bugs[typos.bugs[k]] = bugs[k]\n      delete bugs[k]\n    }\n  })\n}\n"]},"metadata":{},"sourceType":"script"}